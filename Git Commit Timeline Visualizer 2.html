<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Git Commit Timeline Visualizer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .control-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .input-section {
            margin-bottom: 25px;
        }

        .input-section h3 {
            margin-bottom: 15px;
            color: #2c3e50;
            font-size: 1.1rem;
        }

        textarea {
            width: 100%;
            height: 200px;
            padding: 15px;
            border: 2px solid #e1e8ed;
            border-radius: 12px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9rem;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .controls-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
        }

        .control-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        select, input {
            padding: 12px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 0.9rem;
            transition: border-color 0.3s ease;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #495057;
            border: 2px solid #e1e8ed;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .stats-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-card h4 {
            font-size: 2rem;
            margin-bottom: 5px;
        }

        .stat-card p {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .timeline-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            min-height: 400px;
        }

        .timeline {
            position: relative;
            padding: 20px 0;
        }

        .timeline-item {
            display: flex;
            margin-bottom: 30px;
            align-items: center;
            position: relative;
            animation: fadeInUp 0.6s ease forwards;
            opacity: 0;
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .timeline-item {
            transform: translateY(20px);
        }

        .timeline-dot {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            margin-right: 20px;
            flex-shrink: 0;
            position: relative;
            z-index: 2;
        }

        .timeline-content {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            flex-grow: 1;
            border-left: 4px solid #667eea;
            transition: transform 0.3s ease;
        }

        .timeline-content:hover {
            transform: translateX(5px);
        }

        .commit-hash {
            font-family: 'Monaco', 'Menlo', monospace;
            background: #e9ecef;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            color: #495057;
        }

        .commit-message {
            font-weight: 600;
            margin: 10px 0;
            color: #2c3e50;
        }

        .commit-meta {
            font-size: 0.85rem;
            color: #6c757d;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .branch-tag {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .files-changed {
            color: #28a745;
            font-weight: 600;
        }

        .chart-view {
            height: 400px;
            position: relative;
            margin-top: 20px;
        }

        .bar-chart {
            display: flex;
            align-items: end;
            height: 300px;
            gap: 10px;
            padding: 20px;
            border-bottom: 2px solid #e1e8ed;
            border-left: 2px solid #e1e8ed;
        }

        .bar {
            background: linear-gradient(to top, #667eea, #764ba2);
            min-width: 30px;
            border-radius: 4px 4px 0 0;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .bar:hover {
            transform: scaleY(1.05);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .bar-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%) rotate(-45deg);
            font-size: 0.7rem;
            white-space: nowrap;
            transform-origin: top left;
        }

        .heatmap {
            display: grid;
            grid-template-columns: repeat(53, 1fr);
            gap: 2px;
            padding: 20px;
        }

        .heatmap-cell {
            aspect-ratio: 1;
            border-radius: 2px;
            background: #e1e8ed;
            transition: all 0.3s ease;
        }

        .heatmap-cell.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        .filter-chips {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .chip {
            padding: 6px 12px;
            background: #e9ecef;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .chip.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .search-box {
            position: relative;
            margin-bottom: 20px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 20px 12px 40px;
            border-radius: 25px;
            border: 2px solid #e1e8ed;
        }

        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
        }

        .no-data {
            text-align: center;
            padding: 60px 20px;
            color: #6c757d;
        }

        .no-data svg {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .controls-row {
                grid-template-columns: 1fr;
            }
            
            .btn-group {
                justify-content: center;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Git Timeline Visualizer</h1>
            <p>Analyze and visualize your Git commit history with professional insights</p>
        </div>

        <div class="control-panel">
            <div class="input-section">
                <h3>üìã Paste Your Git Log Data</h3>
                <textarea id="commitInput" placeholder="Paste your git log output here...

Example format:
commit abc123def456 (origin/main, main)
Author: John Doe <john@example.com>
Date: Mon Jan 15 14:30:25 2024 -0800
    feat: add user authentication system
    
commit def456ghi789
Author: Jane Smith <jane@example.com>
Date: Sun Jan 14 16:45:12 2024 -0800
    fix: resolve memory leak in data processing

Or try the sample data button below!"></textarea>
            </div>

            <div class="controls-row">
                <div class="control-group">
                    <label for="viewMode">üìä View Mode</label>
                    <select id="viewMode">
                        <option value="timeline">Timeline View</option>
                        <option value="chart">Bar Chart</option>
                        <option value="heatmap">Activity Heatmap</option>
                    </select>
                </div>

                <div class="control-group">
                    <label for="groupBy">üìÖ Group By</label>
                    <select id="groupBy">
                        <option value="none">No Grouping</option>
                        <option value="day">By Day</option>
                        <option value="week">By Week</option>
                        <option value="month">By Month</option>
                        <option value="author">By Author</option>
                    </select>
                </div>

                <div class="control-group">
                    <label for="sortOrder">üîÑ Sort Order</label>
                    <select id="sortOrder">
                        <option value="newest">Newest First</option>
                        <option value="oldest">Oldest First</option>
                    </select>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn-primary" onclick="parseAndVisualize()">üöÄ Visualize Timeline</button>
                <button class="btn-secondary" onclick="loadSampleData()">üìù Load Sample Data</button>
                <button class="btn-secondary" onclick="exportData()">üíæ Export Analysis</button>
                <button class="btn-secondary" onclick="clearData()">üóëÔ∏è Clear All</button>
            </div>
        </div>

        <div class="search-box" id="searchBox" style="display: none;">
            <span class="search-icon">üîç</span>
            <input type="text" id="searchInput" placeholder="Search commits, authors, or messages..." oninput="filterCommits()">
        </div>

        <div class="filter-chips" id="filterChips" style="display: none;"></div>

        <div class="stats-panel" id="statsPanel" style="display: none;">
            <div class="stats-grid" id="statsGrid"></div>
        </div>

        <div class="timeline-container">
            <div id="visualizationArea">
                <div class="no-data">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12A6,6 0 0,0 12,18A6,6 0 0,0 18,12A6,6 0 0,0 12,6M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8Z"/>
                    </svg>
                    <h3>Ready to Visualize</h3>
                    <p>Paste your git log data above and click "Visualize Timeline" to get started</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let commits = [];
        let filteredCommits = [];
        let currentFilters = new Set();

        function loadSampleData() {
            const sampleData = `commit a1b2c3d4e5f6789012345678901234567890abcd (HEAD -> main, origin/main)
Author: Sarah Chen <sarah.chen@company.com>
Date: Mon Jan 15 14:30:25 2024 -0800

    feat: implement advanced user dashboard with real-time analytics
    
    - Added interactive charts using D3.js
    - Implemented WebSocket connections for live updates  
    - Enhanced mobile responsiveness
    - Added comprehensive error handling

commit b2c3d4e5f6789012345678901234567890abcdef1
Author: Michael Rodriguez <m.rodriguez@company.com>  
Date: Sun Jan 14 16:45:12 2024 -0800

    fix: resolve critical memory leak in data processing pipeline
    
    - Optimized garbage collection in worker threads
    - Fixed recursive function stack overflow
    - Added memory usage monitoring
    - Implemented automated cleanup routines

commit c3d4e5f6789012345678901234567890abcdef12 (feature/auth-system)
Author: Emily Watson <emily.w@company.com>
Date: Sat Jan 13 09:15:30 2024 -0800

    feat: add OAuth 2.0 authentication system
    
    - Integrated Google and GitHub OAuth providers
    - Added JWT token management
    - Implemented secure session handling
    - Created comprehensive test suite

commit d4e5f6789012345678901234567890abcdef123
Author: David Kim <david.kim@company.com>
Date: Fri Jan 12 11:20:45 2024 -0800

    refactor: modernize codebase with TypeScript migration
    
    - Converted 95% of JavaScript files to TypeScript
    - Added strict type checking
    - Updated build pipeline configuration
    - Improved IDE development experience

commit e5f6789012345678901234567890abcdef1234
Author: Sarah Chen <sarah.chen@company.com>
Date: Thu Jan 11 13:45:18 2024 -0800

    docs: update API documentation and developer guides
    
    - Added comprehensive API reference
    - Created interactive examples
    - Updated installation instructions
    - Added troubleshooting section

commit f6789012345678901234567890abcdef12345
Author: Alex Thompson <alex.t@company.com>
Date: Wed Jan 10 10:30:22 2024 -0800

    perf: optimize database queries and caching strategy
    
    - Implemented Redis caching layer
    - Added database query optimization
    - Reduced API response times by 60%
    - Added performance monitoring tools

commit 789012345678901234567890abcdef123456
Author: Maria Garcia <maria.garcia@company.com>
Date: Tue Jan 9 15:15:33 2024 -0800

    test: add comprehensive unit and integration tests
    
    - Achieved 95% code coverage
    - Added automated testing pipeline
    - Implemented E2E testing with Cypress
    - Added performance benchmarking

commit 89012345678901234567890abcdef1234567
Author: Michael Rodriguez <m.rodriguez@company.com>
Date: Mon Jan 8 12:00:15 2024 -0800

    feat: implement advanced search functionality
    
    - Added full-text search with Elasticsearch
    - Implemented search filters and sorting
    - Added search result highlighting
    - Optimized search performance`;

            document.getElementById('commitInput').value = sampleData;
            parseAndVisualize();
        }

        function parseCommits(gitLogText) {
            const commits = [];
            const commitBlocks = gitLogText.split(/^commit /m).filter(block => block.trim());
            
            commitBlocks.forEach(block => {
                const lines = block.trim().split('\n');
                if (lines.length < 3) return;
                
                const hash = lines[0].split(' ')[0];
                const authorMatch = lines.find(line => line.startsWith('Author:'));
                const dateMatch = lines.find(line => line.startsWith('Date:'));
                
                if (!authorMatch || !dateMatch) return;
                
                const author = authorMatch.replace('Author:', '').trim();
                const email = author.match(/<([^>]+)>/)?.[1] || '';
                const authorName = author.replace(/<[^>]+>/, '').trim();
                const dateStr = dateMatch.replace('Date:', '').trim();
                const date = new Date(dateStr);
                
                const messageLines = lines.slice(lines.findIndex(line => line.startsWith('Date:')) + 1)
                    .filter(line => line.trim())
                    .map(line => line.replace(/^\s{4}/, ''));
                
                const message = messageLines[0] || 'No commit message';
                const description = messageLines.slice(1).join('\n').trim();
                
                // Extract branch info from first line
                const branchMatch = lines[0].match(/\(([^)]+)\)/);
                const branches = branchMatch ? branchMatch[1].split(',').map(b => b.trim()) : [];
                
                // Estimate files changed (mock data for demo)
                const filesChanged = Math.floor(Math.random() * 10) + 1;
                const linesAdded = Math.floor(Math.random() * 100) + 1;
                const linesDeleted = Math.floor(Math.random() * 50);
                
                commits.push({
                    hash: hash.substring(0, 8),
                    fullHash: hash,
                    author: authorName,
                    email,
                    date,
                    message,
                    description,
                    branches,
                    filesChanged,
                    linesAdded,
                    linesDeleted
                });
            });
            
            return commits.sort((a, b) => b.date - a.date);
        }

        function generateStats(commits) {
            const totalCommits = commits.length;
            const authors = [...new Set(commits.map(c => c.author))];
            const totalFiles = commits.reduce((sum, c) => sum + c.filesChanged, 0);
            const totalLines = commits.reduce((sum, c) => sum + c.linesAdded + c.linesDeleted, 0);
            
            const dateRange = commits.length > 0 ? 
                Math.ceil((commits[0].date - commits[commits.length - 1].date) / (1000 * 60 * 60 * 24)) : 0;
                
            const avgCommitsPerDay = dateRange > 0 ? (totalCommits / dateRange).toFixed(1) : '0';
            
            return [
                { label: 'Total Commits', value: totalCommits },
                { label: 'Contributors', value: authors.length },
                { label: 'Files Changed', value: totalFiles },
                { label: 'Lines Modified', value: totalLines },
                { label: 'Days Active', value: dateRange },
                { label: 'Avg Commits/Day', value: avgCommitsPerDay }
            ];
        }

        function renderStats(stats) {
            const statsGrid = document.getElementById('statsGrid');
            statsGrid.innerHTML = stats.map(stat => `
                <div class="stat-card">
                    <h4>${stat.value}</h4>
                    <p>${stat.label}</p>
                </div>
            `).join('');
        }

        function renderTimeline(commits) {
            const timeline = document.createElement('div');
            timeline.className = 'timeline';
            
            commits.forEach((commit, index) => {
                const item = document.createElement('div');
                item.className = 'timeline-item';
                item.style.animationDelay = `${index * 0.1}s`;
                
                const branchTags = commit.branches.map(branch => 
                    `<span class="branch-tag">${branch}</span>`
                ).join(' ');
                
                item.innerHTML = `
                    <div class="timeline-dot"></div>
                    <div class="timeline-content">
                        <div class="commit-hash">${commit.hash}</div>
                        <div class="commit-message">${commit.message}</div>
                        ${commit.description ? `<div style="margin: 10px 0; color: #6c757d; font-size: 0.9rem;">${commit.description}</div>` : ''}
                        <div class="commit-meta">
                            <span>üë§ ${commit.author}</span>
                            <span>üìÖ ${commit.date.toLocaleDateString()}</span>
                            <span>üïê ${commit.date.toLocaleTimeString()}</span>
                            <span class="files-changed">üìÅ ${commit.filesChanged} files</span>
                            <span style="color: #28a745;">+${commit.linesAdded}</span>
                            <span style="color: #dc3545;">-${commit.linesDeleted}</span>
                        </div>
                        ${branchTags ? `<div style="margin-top: 10px;">${branchTags}</div>` : ''}
                    </div>
                `;
                
                timeline.appendChild(item);
            });
            
            return timeline;
        }

        function renderBarChart(commits) {
            const groupBy = document.getElementById('groupBy').value;
            let groupedData = {};
            
            if (groupBy === 'author') {
                commits.forEach(commit => {
                    groupedData[commit.author] = (groupedData[commit.author] || 0) + 1;
                });
            } else if (groupBy === 'day') {
                commits.forEach(commit => {
                    const day = commit.date.toDateString();
                    groupedData[day] = (groupedData[day] || 0) + 1;
                });
            } else if (groupBy === 'week') {
                commits.forEach(commit => {
                    const week = getWeekNumber(commit.date);
                    const weekKey = `Week ${week}, ${commit.date.getFullYear()}`;
                    groupedData[weekKey] = (groupedData[weekKey] || 0) + 1;
                });
            } else if (groupBy === 'month') {
                commits.forEach(commit => {
                    const month = commit.date.toLocaleDateString('en-US', { year: 'numeric', month: 'long' });
                    groupedData[month] = (groupedData[month] || 0) + 1;
                });
            } else {
                commits.forEach((commit, index) => {
                    groupedData[`Commit ${index + 1}`] = 1;
                });
            }
            
            const maxValue = Math.max(...Object.values(groupedData));
            const chartContainer = document.createElement('div');
            chartContainer.className = 'chart-view';
            
            const barChart = document.createElement('div');
            barChart.className = 'bar-chart';
            
            Object.entries(groupedData).forEach(([key, value]) => {
                const bar = document.createElement('div');
                bar.className = 'bar';
                bar.style.height = `${(value / maxValue) * 100}%`;
                bar.title = `${key}: ${value} commits`;
                
                const label = document.createElement('div');
                label.className = 'bar-label';
                label.textContent = key.length > 15 ? key.substring(0, 15) + '...' : key;
                
                bar.appendChild(label);
                barChart.appendChild(bar);
            });
            
            chartContainer.appendChild(barChart);
            return chartContainer;
        }

        function renderHeatmap(commits) {
            const heatmapContainer = document.createElement('div');
            heatmapContainer.innerHTML = '<h3 style="margin-bottom: 20px; text-align: center;">üìà Commit Activity Heatmap (Last Year)</h3>';
            
            const heatmap = document.createElement('div');
            heatmap.className = 'heatmap';
            
            const today = new Date();
            const yearAgo = new Date(today.getFullYear() - 1, today.getMonth(), today.getDate());
            
            // Create activity map
            const activityMap = {};
            commits.forEach(commit => {
                const dateKey = commit.date.toDateString();
                activityMap[dateKey] = (activityMap[dateKey] || 0) + 1;
            });
            
            // Generate 365 days of cells
            for (let i = 0; i < 365; i++) {
                const date = new Date(yearAgo);
                date.setDate(date.getDate() + i);
                const dateKey = date.toDateString();
                
                const cell = document.createElement('div');
                cell.className = 'heatmap-cell';
                cell.title = `${date.toDateString()}: ${activityMap[dateKey] || 0} commits`;
                
                if (activityMap[dateKey]) {
                    cell.classList.add('active');
                    cell.style.opacity = Math.min(activityMap[dateKey] / 5, 1);
                }
                
                heatmap.appendChild(cell);
            }
            
            heatmapContainer.appendChild(heatmap);
            return heatmapContainer;
        }

        function getWeekNumber(date) {
            const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));
            const dayNum = d.getUTCDay() || 7;
            d.setUTCDate(d.getUTCDate() + 4 - dayNum);
            const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));
            return Math.ceil((((d - yearStart) / 86400000) + 1) / 7);
        }

        function generateFilterChips(commits) {
            const authors = [...new Set(commits.map(c => c.author))];
            const branches = [...new Set(commits.flatMap(c => c.branches))];
            
            const chipsContainer = document.getElementById('filterChips');
            chipsContainer.innerHTML = '';
            
            authors.forEach(author => {
                const chip = document.createElement('div');
                chip.className = 'chip';
                chip.textContent = `üë§ ${author}`;
                chip.onclick = () => toggleFilter('author', author);
                chipsContainer.appendChild(chip);
            });
            
            branches.forEach(branch => {
                if (branch) {
                    const chip = document.createElement('div');
                    chip.className = 'chip';
                    chip.textContent = `üåø ${branch}`;
                    chip.onclick = () => toggleFilter('branch', branch);
                    chipsContainer.appendChild(chip);
                }
            });
        }

        function toggleFilter(type, value) {
            const filterKey = `${type}:${value}`;
            const chip = event.target;
            
            if (currentFilters.has(filterKey)) {
                currentFilters.delete(filterKey);
                chip.classList.remove('active');
            } else {
                currentFilters.add(filterKey);
                chip.classList.add('active');
            }
            
            applyFilters();
        }

        function applyFilters() {
            if (currentFilters.size === 0) {
                filteredCommits = [...commits];
            } else {
                filteredCommits = commits.filter(commit => {
                    return Array.from(currentFilters).some(filter => {
                        const [type, value] = filter.split(':');
                        if (type === 'author') return commit.author === value;
                        if (type === 'branch') return commit.branches.includes(value);
                        return false;
                    });
                });
            }
            
            updateVisualization();
        }

        function filterCommits() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            if (!searchTerm) {
                applyFilters();
                return;
            }
            
            const baseCommits = currentFilters.size === 0 ? commits : 
                commits.filter(commit => {
                    return Array.from(currentFilters).some(filter => {
                        const [type, value] = filter.split(':');
                        if (type === 'author') return commit.author === value;
                        if (type === 'branch') return commit.branches.includes(value);
                        return false;
                    });
                });
            
            filteredCommits = baseCommits.filter(commit => 
                commit.message.toLowerCase().includes(searchTerm) ||
                commit.author.toLowerCase().includes(searchTerm) ||
                commit.description.toLowerCase().includes(searchTerm) ||
                commit.hash.toLowerCase().includes(searchTerm)
            );
            
            updateVisualization();
        }

        function updateVisualization() {
            const viewMode = document.getElementById('viewMode').value;
            const sortOrder = document.getElementById('sortOrder').value;
            
            // Sort commits
            const sortedCommits = [...filteredCommits].sort((a, b) => {
                return sortOrder === 'newest' ? b.date - a.date : a.date - b.date;
            });
            
            const visualizationArea = document.getElementById('visualizationArea');
            
            switch (viewMode) {
                case 'timeline':
                    visualizationArea.innerHTML = '';
                    visualizationArea.appendChild(renderTimeline(sortedCommits));
                    break;
                case 'chart':
                    visualizationArea.innerHTML = '';
                    visualizationArea.appendChild(renderBarChart(sortedCommits));
                    break;
                case 'heatmap':
                    visualizationArea.innerHTML = '';
                    visualizationArea.appendChild(renderHeatmap(sortedCommits));
                    break;
            }
            
            // Update stats
            const stats = generateStats(sortedCommits);
            renderStats(stats);
        }

        function parseAndVisualize() {
            const input = document.getElementById('commitInput').value.trim();
            
            if (!input) {
                alert('Please paste your git log data first!');
                return;
            }
            
            try {
                commits = parseCommits(input);
                filteredCommits = [...commits];
                
                if (commits.length === 0) {
                    alert('No valid commits found. Please check your git log format.');
                    return;
                }
                
                // Show additional controls
                document.getElementById('searchBox').style.display = 'block';
                document.getElementById('filterChips').style.display = 'flex';
                document.getElementById('statsPanel').style.display = 'block';
                
                // Generate filter chips
                generateFilterChips(commits);
                
                // Initial visualization
                updateVisualization();
                
                // Success feedback
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = '‚úÖ Timeline Generated!';
                btn.style.background = 'linear-gradient(135deg, #28a745, #20c997)';
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '';
                }, 2000);
                
            } catch (error) {
                console.error('Parsing error:', error);
                alert('Error parsing git log data. Please check the format and try again.');
            }
        }

        function exportData() {
            if (commits.length === 0) {
                alert('No data to export. Please parse some commits first.');
                return;
            }
            
            const exportData = {
                summary: {
                    totalCommits: commits.length,
                    contributors: [...new Set(commits.map(c => c.author))].length,
                    dateRange: {
                        from: commits[commits.length - 1].date.toISOString(),
                        to: commits[0].date.toISOString()
                    },
                    topContributors: getTopContributors(commits, 5),
                    commitsByMonth: getCommitsByMonth(commits)
                },
                commits: commits.map(commit => ({
                    hash: commit.hash,
                    author: commit.author,
                    date: commit.date.toISOString(),
                    message: commit.message,
                    filesChanged: commit.filesChanged,
                    linesAdded: commit.linesAdded,
                    linesDeleted: commit.linesDeleted,
                    branches: commit.branches
                }))
            };
            
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `git-analysis-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            // Success feedback
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = 'üíæ Exported!';
            setTimeout(() => btn.textContent = originalText, 2000);
        }

        function getTopContributors(commits, limit) {
            const contributors = {};
            commits.forEach(commit => {
                contributors[commit.author] = (contributors[commit.author] || 0) + 1;
            });
            
            return Object.entries(contributors)
                .sort(([,a], [,b]) => b - a)
                .slice(0, limit)
                .map(([author, count]) => ({ author, commits: count }));
        }

        function getCommitsByMonth(commits) {
            const months = {};
            commits.forEach(commit => {
                const month = commit.date.toLocaleDateString('en-US', { year: 'numeric', month: 'long' });
                months[month] = (months[month] || 0) + 1;
            });
            return months;
        }

        function clearData() {
            document.getElementById('commitInput').value = '';
            commits = [];
            filteredCommits = [];
            currentFilters.clear();
            
            // Hide controls
            document.getElementById('searchBox').style.display = 'none';
            document.getElementById('filterChips').style.display = 'none';
            document.getElementById('statsPanel').style.display = 'none';
            
            // Reset visualization
            document.getElementById('visualizationArea').innerHTML = `
                <div class="no-data">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12A6,6 0 0,0 12,18A6,6 0 0,0 18,12A6,6 0 0,0 12,6M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8Z"/>
                    </svg>
                    <h3>Ready to Visualize</h3>
                    <p>Paste your git log data above and click "Visualize Timeline" to get started</p>
                </div>
            `;
            
            // Success feedback
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = 'üóëÔ∏è Cleared!';
            setTimeout(() => btn.textContent = originalText, 1500);
        }

        // Event listeners for real-time updates
        document.getElementById('viewMode').addEventListener('change', () => {
            if (commits.length > 0) updateVisualization();
        });

        document.getElementById('groupBy').addEventListener('change', () => {
            if (commits.length > 0) updateVisualization();
        });

        document.getElementById('sortOrder').addEventListener('change', () => {
            if (commits.length > 0) updateVisualization();
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                switch (e.key) {
                    case 'Enter':
                        e.preventDefault();
                        parseAndVisualize();
                        break;
                    case 'k':
                        e.preventDefault();
                        document.getElementById('searchInput').focus();
                        break;
                    case 's':
                        e.preventDefault();
                        if (commits.length > 0) exportData();
                        break;
                }
            }
        });

        // Initialize tooltips and animations
        document.addEventListener('DOMContentLoaded', () => {
            // Add smooth scrolling
            document.documentElement.style.scrollBehavior = 'smooth';
            
            // Add loading animation to buttons
            const buttons = document.querySelectorAll('button');
            buttons.forEach(btn => {
                btn.addEventListener('click', function() {
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => this.style.transform = '', 150);
                });
            });
            
            // Add focus styles for accessibility
            const focusableElements = document.querySelectorAll('input, select, textarea, button');
            focusableElements.forEach(el => {
                el.addEventListener('focus', () => {
                    el.style.outline = '3px solid rgba(102, 126, 234, 0.3)';
                    el.style.outlineOffset = '2px';
                });
                
                el.addEventListener('blur', () => {
                    el.style.outline = '';
                    el.style.outlineOffset = '';
                });
            });
        });

        // Advanced features for Apple-level polish
        function addAdvancedFeatures() {
            // Auto-save functionality
            const textarea = document.getElementById('commitInput');
            textarea.addEventListener('input', debounce(() => {
                if (textarea.value.trim()) {
                    sessionStorage.setItem('gitTimelineData', textarea.value);
                }
            }, 1000));
            
            // Restore saved data
            const savedData = sessionStorage.getItem('gitTimelineData');
            if (savedData) {
                textarea.value = savedData;
                const restoreBtn = document.createElement('button');
                restoreBtn.textContent = 'üîÑ Restore Previous Session';
                restoreBtn.className = 'btn-secondary';
                restoreBtn.style.marginTop = '10px';
                restoreBtn.onclick = () => {
                    parseAndVisualize();
                    restoreBtn.remove();
                };
                textarea.parentNode.appendChild(restoreBtn);
            }
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Performance monitoring for Apple-level optimization
        let performanceMetrics = {
            parseTime: 0,
            renderTime: 0,
            totalCommits: 0
        };

        function measurePerformance(fn, metricName) {
            return function(...args) {
                const start = performance.now();
                const result = fn.apply(this, args);
                const end = performance.now();
                performanceMetrics[metricName] = end - start;
                
                // Log performance in development
                if (window.location.hostname === 'localhost') {
                    console.log(`${metricName}: ${(end - start).toFixed(2)}ms`);
                }
                
                return result;
            };
        }

        // Wrap critical functions with performance monitoring
        const originalParseCommits = parseCommits;
        parseCommits = measurePerformance(originalParseCommits, 'parseTime');

        const originalUpdateVisualization = updateVisualization;
        updateVisualization = measurePerformance(originalUpdateVisualization, 'renderTime');

        // Initialize advanced features
        addAdvancedFeatures();
    </script>
</body>
</html>